(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40084,       1108]
NotebookOptionsPosition[     37968,       1034]
NotebookOutlinePosition[     38336,       1050]
CellTagsIndexPosition[     38293,       1047]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7091578867224846`*^9, 3.7091578972225266`*^9}},
 ExpressionUUID -> "851eccf4-c4dd-4c15-8481-a6be8f3cc6c5"],

Cell[CellGroupData[{

Cell["Qy and Qx for ideal dipole", "Subsection",
 CellChangeTimes->{{3.709597373398559*^9, 3.7095973915056467`*^9}, {
  3.70959746849562*^9, 3.709597475810329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"uE", "=", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"], " ", 
    RowBox[{"Cos", "[", "ti", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[Beta]"}], " ", "uE"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{"p", ",", 
     RowBox[{"{", 
      RowBox[{"ti", ",", "0", ",", 
       RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "q"], 
    RowBox[{"D", "[", 
     RowBox[{"q", ",", 
      SubscriptBox["\[CapitalEpsilon]", "y"]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CapitalEpsilon]", "y"], ",", "0", ",", "3"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.703414342683012*^9, 3.703414443007979*^9}, {
   3.703414598649268*^9, 3.7034146210083227`*^9}, 3.703414703244411*^9, {
   3.7054189805320234`*^9, 3.705418984216973*^9}, {3.705419219604803*^9, 
   3.7054192229246955`*^9}, {3.7054202231114445`*^9, 
   3.7054202243584776`*^9}, {3.7056602864181256`*^9, 
   3.7056602868702435`*^9}, {3.708875415368763*^9, 3.7088754155507517`*^9}, {
   3.7088755657163677`*^9, 3.708875567910325*^9}, {3.7088773144783707`*^9, 
   3.70887731469409*^9}, {3.7088773573364987`*^9, 3.708877437009181*^9}, {
   3.708877476807617*^9, 3.7088774863076587`*^9}, {3.7088776485195417`*^9, 
   3.708877682026741*^9}, {3.7088780833050385`*^9, 3.708878096290004*^9}, {
   3.708878523053813*^9, 3.7088785287927256`*^9}, {3.708878744174431*^9, 
   3.7088787457259636`*^9}, {3.7091615069600487`*^9, 3.709161536863146*^9}, {
   3.7091622470208197`*^9, 3.709162248841607*^9}, {3.70959740905475*^9, 
   3.709597438527534*^9}, {3.7095974794212027`*^9, 3.709597479863286*^9}},
 ExpressionUUID -> "b449e661-9edb-49e5-bdff-693e511d5321"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"]}], "-", 
   RowBox[{
    FractionBox["1", "16"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Beta]", "4"], " ", 
      SuperscriptBox["\[Mu]", "4"]}], ")"}], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      SubscriptBox["\[CapitalEpsilon]", "y"], "]"}], "4"],
    SeriesData[
     Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 0, {}, 1, 4, 
     1],
    Editable->False]}],
  SeriesData[
   Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 0, {
   Rational[1, 2] $CellContext`\[Beta]^2 $CellContext`\[Mu]^2, 0, 
    Rational[-1, 16] $CellContext`\[Beta]^4 $CellContext`\[Mu]^4}, 1, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.709597447176597*^9, 3.7095974817427607`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["vE and vEE from taylor expansion", "Subsection",
 CellChangeTimes->{{3.708875254643957*^9, 3.7088752768638086`*^9}, {
  3.70916316964465*^9, 
  3.709163179928233*^9}},ExpressionUUID->"58f0e199-7417-4bbb-916f-\
6a218b1ba2f8"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.709597489331605*^9, 3.709597496159616*^9}}],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"need", " ", "to", " ", "solve", 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", "\[CapitalEpsilon]"}]], 
      RowBox[{"(", 
       FractionBox["p", "q"], ")"}]}]}], "+", 
    RowBox[{"\[Gradient]", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["p", "q"], "V"}], ")"}]}]}], "\[Equal]", "0"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7058595222398024`*^9, 
  3.7058595306623573`*^9}},ExpressionUUID->"abae7fad-4950-458b-92f5-\
99b2f667a7e9"]], "Text",
 CellChangeTimes->{
  3.708875297832551*^9, {3.7091634651823025`*^9, 
   3.709163478596362*^9}},ExpressionUUID->"81751ff0-7c98-49f5-b50b-\
22b159e73dec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"uE", "=", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"], " ", 
    RowBox[{"Cos", "[", "ti", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[Beta]"}], " ", "uE"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{"p", ",", 
     RowBox[{"{", 
      RowBox[{"ti", ",", "0", ",", 
       RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pq", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"p", "/", "q"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[CapitalEpsilon]", "y"], ",", "0", ",", "3"}], "}"}]}], 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dpqdE", "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{"pq", ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[CapitalEpsilon]", "y"], ",", "0", ",", "3"}], 
        "}"}]}], "]"}], "]"}], ",", 
    SubscriptBox["\[CapitalEpsilon]", "y"]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.703414342683012*^9, 3.703414443007979*^9}, {
   3.703414598649268*^9, 3.7034146210083227`*^9}, 3.703414703244411*^9, {
   3.7054189805320234`*^9, 3.705418984216973*^9}, {3.705419219604803*^9, 
   3.7054192229246955`*^9}, {3.7054202231114445`*^9, 
   3.7054202243584776`*^9}, {3.7056602864181256`*^9, 
   3.7056602868702435`*^9}, {3.708875415368763*^9, 3.7088754155507517`*^9}, {
   3.7088755657163677`*^9, 3.708875567910325*^9}, {3.7088773144783707`*^9, 
   3.70887731469409*^9}, {3.7088773573364987`*^9, 3.708877437009181*^9}, {
   3.708877476807617*^9, 3.7088774863076587`*^9}, {3.7088776485195417`*^9, 
   3.708877682026741*^9}, {3.7088780833050385`*^9, 3.708878096290004*^9}, {
   3.708878523053813*^9, 3.7088785287927256`*^9}, {3.708878744174431*^9, 
   3.7088787457259636`*^9}, {3.7091615069600487`*^9, 3.709161536863146*^9}, {
   3.7091622470208197`*^9, 3.709162248841607*^9}},
 ExpressionUUID -> "b449e661-9edb-49e5-bdff-693e511d5321"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Pi]"}]], "+", 
  FractionBox[
   RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
    RowBox[{"Cos", "[", "ti", "]"}], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"]}], 
   RowBox[{"2", " ", "\[Pi]"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Beta]", "2"], " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "ti", "]"}], "2"]}]}], ")"}], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "2"]}], 
   RowBox[{"8", " ", "\[Pi]"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Beta]", "3"], " ", 
    SuperscriptBox["\[Mu]", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "ti", "]"}], "3"]}]}], ")"}], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "3"]}], 
   RowBox[{"24", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{
  3.7088773238039846`*^9, {3.7088773626702843`*^9, 3.7088774402744584`*^9}, 
   3.7088774900593233`*^9, 3.708877685051876*^9, 3.708878059120246*^9, 
   3.7088781050336742`*^9, 3.708878493789775*^9, 3.7088785343949842`*^9, 
   3.708878748509078*^9, 3.7091615420967283`*^9, 3.7091622515927134`*^9, 
   3.70916249568874*^9, 3.709162547530655*^9, {3.7091626222581825`*^9, 
   3.709162636340843*^9}, 3.7091628796892033`*^9, 3.709162929455411*^9, 
   3.7091629692504764`*^9, 3.7094629306448936`*^9, 3.709504404626727*^9},
 ExpressionUUID -> "317764ca-4055-4bc1-9c4c-2c48bf52d9e8"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
    RowBox[{"Cos", "[", "ti", "]"}]}], 
   RowBox[{"2", " ", "\[Pi]"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Beta]", "2"], " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "ti", "]"}], "2"]}]}], ")"}], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"]}], 
   RowBox[{"4", " ", "\[Pi]"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Beta]", "3"], " ", 
    SuperscriptBox["\[Mu]", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "ti", "]"}], "3"]}]}], ")"}], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "2"]}], 
   RowBox[{"8", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{
  3.7088773238039846`*^9, {3.7088773626702843`*^9, 3.7088774402744584`*^9}, 
   3.7088774900593233`*^9, 3.708877685051876*^9, 3.708878059120246*^9, 
   3.7088781050336742`*^9, 3.708878493789775*^9, 3.7088785343949842`*^9, 
   3.708878748509078*^9, 3.7091615420967283`*^9, 3.7091622515927134`*^9, 
   3.70916249568874*^9, 3.709162547530655*^9, {3.7091626222581825`*^9, 
   3.709162636340843*^9}, 3.7091628796892033`*^9, 3.709162929455411*^9, 
   3.7091629692504764`*^9, 3.7094629306448936`*^9, 3.709504404672791*^9},
 ExpressionUUID -> "317764ca-4055-4bc1-9c4c-2c48bf52d9e8"]
}, Open  ]],

Cell[TextData[{
 "v=v0+vE*Ex+ ",
 Cell[BoxData[
  FormBox[
   RowBox[{"vEE", "*", 
    SuperscriptBox["Ex", "2"]}], TraditionalForm]],ExpressionUUID->
  "a425bd21-6240-4c94-b14d-55766f59ecd3"],
 "\n",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["v", "E"], TraditionalForm]],ExpressionUUID->
  "c39262af-909b-45a0-8a4a-9d8aa1aea537"],
 " = vE + vEE*Ex+VEEE"
}], "Text",
 CellChangeTimes->{{3.708875600116977*^9, 3.708875614481661*^9}, {
  3.708875883960494*^9, 3.7088758984812627`*^9}, {3.7094628725095587`*^9, 
  3.7094628750570602`*^9}},ExpressionUUID->"9507482c-161c-4fb3-b587-\
4ee5666e962e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"dpqdE", "+", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"pq", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vE", "[", "ti", "]"}], "+", 
         RowBox[{
          RowBox[{"vEE", "[", "ti", "]"}], "*", 
          SubscriptBox["\[CapitalEpsilon]", "y"]}]}], ")"}]}], ",", "ti"}], 
     "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CapitalEpsilon]", "y"], ",", "0", ",", "3"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.70887855807097*^9, 3.7088786301747932`*^9}, {
  3.7091623139485683`*^9, 3.7091623158117995`*^9}, {3.7091624706670413`*^9, 
  3.7091624718827505`*^9}, {3.709162526882377*^9, 3.709162540106146*^9}},
 ExpressionUUID -> "65460cb2-ed9a-4637-a3f8-a378aaaa0d0b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
      RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["vE", "\[Prime]",
       MultilineFunction->None], "[", "ti", "]"}]}], 
    RowBox[{"2", " ", "\[Pi]"}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[Beta]", "2"]}], " ", 
        SuperscriptBox["\[Mu]", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Beta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "ti", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", "\[Beta]", " ", "\[Mu]", " ", 
        RowBox[{"Sin", "[", "ti", "]"}], " ", 
        RowBox[{"vE", "[", "ti", "]"}]}], "+", 
       RowBox[{"2", " ", "\[Beta]", " ", "\[Mu]", " ", 
        RowBox[{"Cos", "[", "ti", "]"}], " ", 
        RowBox[{
         SuperscriptBox["vE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["vEE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}]}], ")"}], " ", 
     SubscriptBox["\[CapitalEpsilon]", "y"]}], 
    RowBox[{"4", " ", "\[Pi]"}]], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"8", " ", "\[Pi]"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        SuperscriptBox["\[Beta]", "3"], " ", 
        SuperscriptBox["\[Mu]", "3"], " ", 
        RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Beta]", "3"], " ", 
        SuperscriptBox["\[Mu]", "3"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "ti", "]"}], "3"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[Beta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        RowBox[{"Cos", "[", "ti", "]"}], " ", 
        RowBox[{"Sin", "[", "ti", "]"}], " ", 
        RowBox[{"vE", "[", "ti", "]"}]}], "-", 
       RowBox[{"4", " ", "\[Beta]", " ", "\[Mu]", " ", 
        RowBox[{"Sin", "[", "ti", "]"}], " ", 
        RowBox[{"vEE", "[", "ti", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[Beta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        RowBox[{
         SuperscriptBox["vE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Beta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "ti", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["vE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}], "+", 
       RowBox[{"4", " ", "\[Beta]", " ", "\[Mu]", " ", 
        RowBox[{"Cos", "[", "ti", "]"}], " ", 
        RowBox[{
         SuperscriptBox["vEE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}]}], ")"}], " ", 
     SubsuperscriptBox["\[CapitalEpsilon]", "y", "2"]}]}], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"24", " ", "\[Pi]"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["\[Beta]", "3"], " ", 
        SuperscriptBox["\[Mu]", "3"], " ", 
        RowBox[{"Sin", "[", "ti", "]"}], " ", 
        RowBox[{"vE", "[", "ti", "]"}]}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["\[Beta]", "3"], " ", 
        SuperscriptBox["\[Mu]", "3"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "ti", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "ti", "]"}], " ", 
        RowBox[{"vE", "[", "ti", "]"}]}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[Beta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        RowBox[{"Cos", "[", "ti", "]"}], " ", 
        RowBox[{"Sin", "[", "ti", "]"}], " ", 
        RowBox[{"vEE", "[", "ti", "]"}]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Beta]", "3"], " ", 
        SuperscriptBox["\[Mu]", "3"], " ", 
        RowBox[{"Cos", "[", "ti", "]"}], " ", 
        RowBox[{
         SuperscriptBox["vE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Beta]", "3"], " ", 
        SuperscriptBox["\[Mu]", "3"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "ti", "]"}], "3"], " ", 
        RowBox[{
         SuperscriptBox["vE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Beta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        RowBox[{
         SuperscriptBox["vEE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["\[Beta]", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "ti", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["vEE", "\[Prime]",
          MultilineFunction->None], "[", "ti", "]"}]}]}], ")"}], " ", 
     SubsuperscriptBox["\[CapitalEpsilon]", "y", "3"]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      SubscriptBox["\[CapitalEpsilon]", "y"], "]"}], "4"],
    SeriesData[
     Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 0, {}, 0, 4, 
     1],
    Editable->False]}],
  SeriesData[
   Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 0, {
   Rational[1, 2] 
    Pi^(-1) ($CellContext`\[Beta] $CellContext`\[Mu] Cos[$CellContext`ti] + 
     Derivative[1][$CellContext`vE][$CellContext`ti]), Rational[1, 4] 
    Pi^(-1) (-$CellContext`\[Beta]^2 $CellContext`\[Mu]^2 + 
     2 $CellContext`\[Beta]^2 $CellContext`\[Mu]^2 Cos[$CellContext`ti]^2 - 
     2 $CellContext`\[Beta] $CellContext`\[Mu] 
     Sin[$CellContext`ti] $CellContext`vE[$CellContext`ti] + 
     2 $CellContext`\[Beta] $CellContext`\[Mu] Cos[$CellContext`ti] 
      Derivative[1][$CellContext`vE][$CellContext`ti] + 
     2 Derivative[1][$CellContext`vEE][$CellContext`ti]), Rational[1, 8] 
    Pi^(-1) ((-3) $CellContext`\[Beta]^3 $CellContext`\[Mu]^3 
      Cos[$CellContext`ti] + 
     2 $CellContext`\[Beta]^3 $CellContext`\[Mu]^3 Cos[$CellContext`ti]^3 - 
     4 $CellContext`\[Beta]^2 $CellContext`\[Mu]^2 Cos[$CellContext`ti] 
     Sin[$CellContext`ti] $CellContext`vE[$CellContext`ti] - 
     4 $CellContext`\[Beta] $CellContext`\[Mu] 
     Sin[$CellContext`ti] $CellContext`vEE[$CellContext`ti] - $CellContext`\
\[Beta]^2 $CellContext`\[Mu]^2 
     Derivative[1][$CellContext`vE][$CellContext`ti] + 
     2 $CellContext`\[Beta]^2 $CellContext`\[Mu]^2 Cos[$CellContext`ti]^2 
      Derivative[1][$CellContext`vE][$CellContext`ti] + 
     4 $CellContext`\[Beta] $CellContext`\[Mu] Cos[$CellContext`ti] 
      Derivative[1][$CellContext`vEE][$CellContext`ti]), Rational[1, 24] 
    Pi^(-1) (3 $CellContext`\[Beta]^3 $CellContext`\[Mu]^3 
      Sin[$CellContext`ti] $CellContext`vE[$CellContext`ti] - 
     6 $CellContext`\[Beta]^3 $CellContext`\[Mu]^3 Cos[$CellContext`ti]^2 
     Sin[$CellContext`ti] $CellContext`vE[$CellContext`ti] - 
     12 $CellContext`\[Beta]^2 $CellContext`\[Mu]^2 Cos[$CellContext`ti] 
     Sin[$CellContext`ti] $CellContext`vEE[$CellContext`ti] - 
     3 $CellContext`\[Beta]^3 $CellContext`\[Mu]^3 Cos[$CellContext`ti] 
     Derivative[1][$CellContext`vE][$CellContext`ti] + 
     2 $CellContext`\[Beta]^3 $CellContext`\[Mu]^3 Cos[$CellContext`ti]^3 
      Derivative[1][$CellContext`vE][$CellContext`ti] - 
     3 $CellContext`\[Beta]^2 $CellContext`\[Mu]^2 
     Derivative[1][$CellContext`vEE][$CellContext`ti] + 
     6 $CellContext`\[Beta]^2 $CellContext`\[Mu]^2 Cos[$CellContext`ti]^2 
      Derivative[1][$CellContext`vEE][$CellContext`ti])}, 0, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.7088785834753227`*^9, {3.7088786149602995`*^9, 3.7088786309444532`*^9}, 
   3.708878757129548*^9, 3.70916232612772*^9, {3.709162475620019*^9, 
   3.709162495826618*^9}, {3.709162540625949*^9, 3.7091625476989975`*^9}, {
   3.7091626223363094`*^9, 3.709162636525016*^9}, 3.709162879874466*^9, 
   3.709162929540063*^9, 3.709162971250721*^9, 3.7094629310979843`*^9, 
   3.709504404999926*^9},
 ExpressionUUID -> "a6ca0d56-669e-4b46-809f-73dc0e8139ad"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7091626406628637`*^9, 3.7091626664625273`*^9}},
 ExpressionUUID -> "becda1c2-3569-4e68-8261-e5aff968f0ad"],

Cell[TextData[{
 "each terms should be zero So\n\n",
 Cell[BoxData[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
       RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["vE", "\[Prime]",
        MultilineFunction->None], "[", "ti", "]"}]}], 
     RowBox[{"2", " ", "\[Pi]"}]], "\[Equal]", "0"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Beta]", "2"]}], " ", 
         SuperscriptBox["\[Mu]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Beta]", "2"], " ", 
         SuperscriptBox["\[Mu]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "ti", "]"}], "2"]}], "-", 
        RowBox[{"2", " ", "\[Beta]", " ", "\[Mu]", " ", 
         RowBox[{"Sin", "[", "ti", "]"}], " ", 
         RowBox[{"vE", "[", "ti", "]"}]}], "+", 
        RowBox[{"2", " ", "\[Beta]", " ", "\[Mu]", " ", 
         RowBox[{"Cos", "[", "ti", "]"}], " ", 
         RowBox[{
          SuperscriptBox["vE", "\[Prime]",
           MultilineFunction->None], "[", "ti", "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{
          SuperscriptBox["vEE", "\[Prime]",
           MultilineFunction->None], "[", "ti", "]"}]}]}], ")"}], " ", 
      SubscriptBox["\[CapitalEpsilon]", "y"]}], 
     RowBox[{"4", " ", "\[Pi]"}]], "\[Equal]", "0"}], ";"}]}], "Input",
  FontSize->24,ExpressionUUID->"930050cd-2706-4860-a6c1-c3364b98f561"]
}], "Text",
 CellChangeTimes->{{3.7091623872355213`*^9, 3.70916238731966*^9}, {
  3.7091629831126986`*^9, 3.7091629833785887`*^9}, {3.709163504912501*^9, 
  3.709163515779473*^9}},ExpressionUUID->"cc0ef388-5ad1-4353-9c38-\
fa4997ee7125"],

Cell["solve  for vE", "Text",
 CellChangeTimes->{{3.70916266812464*^9, 3.70916267106021*^9}, {
  3.7091629361550927`*^9, 
  3.709162936885908*^9}},ExpressionUUID->"e15782e7-1b60-489f-a49f-\
16454f52c4a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
       RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["vE", "\[Prime]",
        MultilineFunction->None], "[", "ti", "]"}]}], 
     RowBox[{"2", " ", "\[Pi]"}]], "\[Equal]", "0"}], ",", 
   RowBox[{"vE", "[", "ti", "]"}], ",", "ti"}], "]"}]], "Input",
 CellChangeTimes->{{3.7091626796088133`*^9, 3.709162720305231*^9}, {
  3.7091630023449926`*^9, 3.709163027638047*^9}},
 ExpressionUUID -> "5ba84830-6974-4bda-8cb4-b63e9dd47a65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"vE", "[", "ti", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "-", 
     RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
      RowBox[{"Sin", "[", "ti", "]"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.709162694792624*^9, 3.7091627214892263`*^9}, 
   3.7091629296025677`*^9, 3.7091630279537315`*^9, 3.7094629312698994`*^9, 
   3.709504405187625*^9},
 ExpressionUUID -> "27082567-0d8b-4e44-9668-0e98ffe1cade"]
}, Open  ]],

Cell["For ti=0, vE = 0 so c[1]\[Equal]0", "Text",
 CellChangeTimes->{{3.709163034705307*^9, 
  3.709163058780294*^9}},ExpressionUUID->"e4ba1f15-1f05-40ab-a19c-\
3bf1d90c066f"],

Cell["\<\
Solve for vEE
\
\>", "Text",
 CellChangeTimes->{{3.7091627302531896`*^9, 
  3.7091627464149733`*^9}},ExpressionUUID->"f8317b78-d368-4614-aadb-\
52927066e125"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vE", "[", "ti", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Beta]"}], " ", "\[Mu]", " ", 
    RowBox[{"Sin", "[", "ti", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vE", "[", "ti", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vE", "'"}], "[", "ti", "]"}], "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"vE", "[", "ti", "]"}], ",", "ti"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7091627480986757`*^9, 3.7091628011316133`*^9}, {
  3.709162921967873*^9, 3.7091629241371384`*^9}, {3.709163072149534*^9, 
  3.7091631051614685`*^9}},
 ExpressionUUID -> "830b45e7-6932-452e-9cf8-e6bd8f380105"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[Beta]"}], " ", "\[Mu]", " ", 
  RowBox[{"Sin", "[", "ti", "]"}]}]], "Output",
 CellChangeTimes->{{3.7091630871036644`*^9, 3.709163105798416*^9}, 
   3.7094629313167276`*^9, 3.7095044052668533`*^9},
 ExpressionUUID -> "02441dbc-60ef-434d-b2bf-1bbb159de9dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[Beta]"}], " ", "\[Mu]", " ", 
  RowBox[{"Cos", "[", "ti", "]"}]}]], "Output",
 CellChangeTimes->{{3.7091630871036644`*^9, 3.709163105798416*^9}, 
   3.7094629313167276`*^9, 3.7095044052676764`*^9},
 ExpressionUUID -> "02441dbc-60ef-434d-b2bf-1bbb159de9dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Beta]", "2"]}], " ", 
         SuperscriptBox["\[Mu]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Beta]", "2"], " ", 
         SuperscriptBox["\[Mu]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "ti", "]"}], "2"]}], "-", 
        RowBox[{"2", " ", "\[Beta]", " ", "\[Mu]", " ", 
         RowBox[{"Sin", "[", "ti", "]"}], " ", 
         RowBox[{"vE", "[", "ti", "]"}]}], "+", 
        RowBox[{"2", " ", "\[Beta]", " ", "\[Mu]", " ", 
         RowBox[{"Cos", "[", "ti", "]"}], " ", 
         RowBox[{
          SuperscriptBox["vE", "\[Prime]",
           MultilineFunction->None], "[", "ti", "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{
          SuperscriptBox["vEE", "\[Prime]",
           MultilineFunction->None], "[", "ti", "]"}]}]}], ")"}], " ", 
      SubscriptBox["\[CapitalEpsilon]", "y"]}], 
     RowBox[{"4", " ", "\[Pi]"}]], "\[Equal]", "0"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"vEE", "[", "ti", "]"}], ",", "ti"}], "]"}]], "Input",
 ExpressionUUID -> "8ed5de4e-26bf-4339-bad3-11c534259c66"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"vEE", "[", "ti", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox["\[Beta]", "2"], " ", 
      SuperscriptBox["\[Mu]", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "ti"}], "]"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.709162804107029*^9, {3.7091629252686863`*^9, 3.709162929755886*^9}, 
   3.7091631137142563`*^9, 3.7094629314104705`*^9, 3.709504405351693*^9},
 ExpressionUUID -> "535f1ef2-28cb-46be-9d8b-dbe7ed9ccfee"]
}, Open  ]],

Cell["\<\
similarly c[1]==0
so in sum\
\>", "Text",
 CellChangeTimes->{{3.7091631260270667`*^9, 
  3.709163143994376*^9}},ExpressionUUID->"5e13f748-8b18-4712-aef0-\
cf39bfc588df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vE", "=", 
   RowBox[{
    RowBox[{"-", "\[Beta]"}], " ", "\[Mu]", " ", 
    RowBox[{"Sin", "[", "ti", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vEE", "=", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "ti"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.709163145495186*^9, 3.7091631635270157`*^9}},
 ExpressionUUID -> "1a99c73d-3c01-4b01-8710-63a5f95914f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Second Method", "Subsection",
 CellChangeTimes->{{3.708875254643957*^9, 3.7088752768638086`*^9}, {
  3.70916316964465*^9, 3.709163179928233*^9}, {3.7095972918901453`*^9, 
  3.709597297224011*^9}},
 ExpressionUUID -> "58f0e199-7417-4bbb-916f-6a218b1ba2f8"],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"need", " ", "to", " ", "solve", 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", "\[CapitalEpsilon]"}]], 
      RowBox[{"(", 
       FractionBox["p", "q"], ")"}]}]}], "+", 
    RowBox[{"\[Gradient]", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["p", "q"], "V"}], ")"}]}]}], "\[Equal]", "0"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7058595222398024`*^9, 3.7058595306623573`*^9}},
 ExpressionUUID -> "abae7fad-4950-458b-92f5-99b2f667a7e9"]], "Text",
 CellChangeTimes->{
  3.708875297832551*^9, {3.7091634651823025`*^9, 3.709163478596362*^9}},
 ExpressionUUID -> "81751ff0-7c98-49f5-b50b-22b159e73dec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"uE", "=", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"], " ", 
    RowBox[{"Cos", "[", "ti", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[Beta]"}], " ", "uE"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{"p", ",", 
    RowBox[{"{", 
     RowBox[{"ti", ",", "0", ",", 
      RowBox[{"2", "Pi"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.703414342683012*^9, 3.703414443007979*^9}, {
   3.703414598649268*^9, 3.7034146210083227`*^9}, 3.703414703244411*^9, {
   3.7054189805320234`*^9, 3.705418984216973*^9}, {3.705419219604803*^9, 
   3.7054192229246955`*^9}, {3.7054202231114445`*^9, 
   3.7054202243584776`*^9}, {3.7056602864181256`*^9, 
   3.7056602868702435`*^9}, {3.708875415368763*^9, 3.7088754155507517`*^9}, {
   3.7088755657163677`*^9, 3.708875567910325*^9}, {3.7088773144783707`*^9, 
   3.70887731469409*^9}, {3.7088773573364987`*^9, 3.708877437009181*^9}, {
   3.708877476807617*^9, 3.7088774863076587`*^9}, {3.7088776485195417`*^9, 
   3.708877682026741*^9}, {3.7088780833050385`*^9, 3.708878096290004*^9}, {
   3.708878523053813*^9, 3.7088785287927256`*^9}, {3.708878744174431*^9, 
   3.7088787457259636`*^9}, {3.7091615069600487`*^9, 3.709161536863146*^9}, {
   3.7091622470208197`*^9, 3.709162248841607*^9}, {3.7095942227200212`*^9, 
   3.709594224041786*^9}, {3.7095942893064003`*^9, 3.709594289519205*^9}, 
   3.7095943741217833`*^9},
 ExpressionUUID -> "b449e661-9edb-49e5-bdff-693e511d5321"],

Cell[BoxData[
 RowBox[{"2", " ", "\[Pi]", " ", 
  RowBox[{"BesselI", "[", 
   RowBox[{"0", ",", 
    RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
     SubscriptBox["\[CapitalEpsilon]", "y"]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.709594387823061*^9, 3.709594448741371*^9}, 
   3.709594581636743*^9, 3.7095946413541203`*^9, 3.709594772813197*^9}]
}, Open  ]],

Cell[TextData[{
 "v=v0+vE*Ex+ ",
 Cell[BoxData[
  FormBox[
   RowBox[{"vEE", "*", 
    SuperscriptBox["Ex", "2"]}], TraditionalForm]],
  ExpressionUUID -> "a425bd21-6240-4c94-b14d-55766f59ecd3"],
 "\n",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["v", "E"], TraditionalForm]],
  ExpressionUUID -> "c39262af-909b-45a0-8a4a-9d8aa1aea537"],
 " = vE + vEE*Ex+VEEE"
}], "Text",
 CellChangeTimes->{{3.708875600116977*^9, 3.708875614481661*^9}, {
  3.708875883960494*^9, 3.7088758984812627`*^9}, {3.7094628725095587`*^9, 
  3.7094628750570602`*^9}},
 ExpressionUUID -> "9507482c-161c-4fb3-b587-4ee5666e962e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"p", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", "\[Mu]", " ", 
           RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "q"], 
           RowBox[{"D", "[", 
            RowBox[{"q", ",", 
             SubscriptBox["\[CapitalEpsilon]", "y"]}], "]"}]}]}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[CapitalEpsilon]", "y"], ",", "0", ",", "3"}], 
        "}"}]}], "]"}], ",", "ti"}], "]"}], "/", "p"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.709594168054872*^9, 3.709594260597928*^9}, {
  3.70959434689727*^9, 3.7095943654624434`*^9}, {3.709594400115066*^9, 
  3.709594431551622*^9}, {3.709594564815956*^9, 3.709594565640956*^9}, {
  3.7095946272157087`*^9, 3.709594664031939*^9}, {3.709594695916272*^9, 
  3.7095947256222*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
     RowBox[{"Sin", "[", "ti", "]"}]}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"Cos", "[", "ti", "]"}], " ", 
    RowBox[{"Sin", "[", "ti", "]"}], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"]}], "+", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    SuperscriptBox["\[Beta]", "3"], " ", 
    SuperscriptBox["\[Mu]", "3"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "ti", "]"}], "3"], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "96"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    SuperscriptBox["\[Mu]", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "ti"}], "]"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "ti"}], "]"}], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      SubscriptBox["\[CapitalEpsilon]", "y"], "]"}], "4"],
    SeriesData[
     Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 0, {}, 0, 4, 
     1],
    Editable->False]}],
  SeriesData[
   Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 
   0, {((-$CellContext`\[Beta]) $CellContext`\[Mu]) 
    Sin[$CellContext`ti], (((
       Rational[1, 2] $CellContext`\[Beta]^2) $CellContext`\[Mu]^2) 
     Cos[$CellContext`ti]) 
    Sin[$CellContext`ti], ((
      Rational[1, 6] $CellContext`\[Beta]^3) $CellContext`\[Mu]^3) 
    Sin[$CellContext`ti]^3, (((
       Rational[1, 96] $CellContext`\[Beta]^4) $CellContext`\[Mu]^4) (-4 + 
      Cos[2 $CellContext`ti])) Sin[2 $CellContext`ti]}, 0, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.7095943707727947`*^9, 3.7095944487843113`*^9}, 
   3.7095945817817993`*^9, 3.70959464140635*^9, 3.709594772909318*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"p", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", "\[Mu]", " ", 
           RowBox[{"Cos", "[", "ti", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "q"], 
           RowBox[{"D", "[", 
            RowBox[{"q", ",", 
             SubscriptBox["\[CapitalEpsilon]", "y"]}], "]"}]}]}], ")"}]}], 
       ",", "ti"}], "]"}], "/", "p"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CapitalEpsilon]", "y"], ",", "0", ",", "3"}], "}"}]}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7095944423654537`*^9, 3.709594446692769*^9}, {
   3.7095945769867373`*^9, 3.7095946236420403`*^9}, {3.709594657093236*^9, 
   3.709594693698148*^9}, 3.709594727126849*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"\[Beta]", " ", "\[Mu]", " ", 
     RowBox[{"Sin", "[", "ti", "]"}]}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"Cos", "[", "ti", "]"}], " ", 
    RowBox[{"Sin", "[", "ti", "]"}], " ", 
    SubscriptBox["\[CapitalEpsilon]", "y"]}], "+", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    SuperscriptBox["\[Beta]", "3"], " ", 
    SuperscriptBox["\[Mu]", "3"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "ti", "]"}], "3"], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "96"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    SuperscriptBox["\[Mu]", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "ti"}], "]"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "ti"}], "]"}], " ", 
    SubsuperscriptBox["\[CapitalEpsilon]", "y", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      SubscriptBox["\[CapitalEpsilon]", "y"], "]"}], "4"],
    SeriesData[
     Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 0, {}, 0, 4, 
     1],
    Editable->False]}],
  SeriesData[
   Subscript[$CellContext`\[CapitalEpsilon], $CellContext`y], 
   0, {((-$CellContext`\[Beta]) $CellContext`\[Mu]) 
    Sin[$CellContext`ti], (((
       Rational[1, 2] $CellContext`\[Beta]^2) $CellContext`\[Mu]^2) 
     Cos[$CellContext`ti]) 
    Sin[$CellContext`ti], ((
      Rational[1, 6] $CellContext`\[Beta]^3) $CellContext`\[Mu]^3) 
    Sin[$CellContext`ti]^3, (((
       Rational[1, 96] $CellContext`\[Beta]^4) $CellContext`\[Mu]^4) (-4 + 
      Cos[2 $CellContext`ti])) Sin[2 $CellContext`ti]}, 0, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.709594449971629*^9, 3.7095945818896713`*^9, {3.709594641708006*^9, 
   3.709594658830583*^9}, 3.70959477319711*^9}]
}, Open  ]]
}, Open  ]],

Cell["test for another vEE from zero-order-E", "Subsection",
 CellChangeTimes->{{3.709551520747998*^9, 3.7095515380388193`*^9}}]
},
WindowSize->{683, 671},
WindowMargins->{{1, Automatic}, {Automatic, 11}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 205, 3, 46, "Input"],
Cell[CellGroupData[{
Cell[788, 27, 164, 2, 58, "Subsection"],
Cell[CellGroupData[{
Cell[977, 33, 1986, 45, 187, "Input"],
Cell[2966, 80, 1032, 28, 61, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4047, 114, 230, 4, 58, "Subsection"],
Cell[4280, 120, 142, 2, 46, "Input"],
Cell[4425, 124, 719, 21, 56, "Text"],
Cell[CellGroupData[{
Cell[5169, 149, 2213, 54, 194, "Input"],
Cell[7385, 205, 1697, 43, 132, "Output"],
Cell[9085, 250, 1577, 40, 130, "Output"]
}, Open  ]],
Cell[10677, 293, 595, 17, 74, "Text"],
Cell[CellGroupData[{
Cell[11297, 314, 791, 21, 46, "Input"],
Cell[12091, 337, 8336, 192, 240, "Output"]
}, Open  ]],
Cell[20442, 532, 155, 2, 41, "Input"],
Cell[20600, 536, 1816, 48, 228, "Text"],
Cell[22419, 586, 204, 4, 42, "Text"],
Cell[CellGroupData[{
Cell[22648, 594, 598, 15, 68, "Input"],
Cell[23249, 611, 501, 12, 41, "Output"]
}, Open  ]],
Cell[23765, 626, 175, 3, 42, "Text"],
Cell[23943, 631, 168, 6, 70, "Text"],
Cell[CellGroupData[{
Cell[24136, 641, 669, 17, 98, "Input"],
Cell[24808, 660, 298, 6, 41, "Output"],
Cell[25109, 668, 298, 6, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25444, 679, 1271, 33, 116, "Input"],
Cell[26718, 714, 618, 16, 61, "Output"]
}, Open  ]],
Cell[27351, 733, 179, 6, 70, "Text"],
Cell[27533, 741, 552, 15, 95, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28122, 761, 261, 4, 58, "Subsection"],
Cell[28386, 767, 716, 19, 56, "Text"],
Cell[CellGroupData[{
Cell[29127, 790, 1672, 35, 129, "Input"],
Cell[30802, 827, 346, 7, 45, "Output"]
}, Open  ]],
Cell[31163, 837, 601, 17, 74, "Text"],
Cell[CellGroupData[{
Cell[31789, 858, 1022, 28, 68, "Input"],
Cell[32814, 888, 2033, 53, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34884, 946, 890, 25, 68, "Input"],
Cell[35777, 973, 2032, 54, 61, "Output"]
}, Open  ]]
}, Open  ]],
Cell[37836, 1031, 128, 1, 58, "Subsection"]
}
]
*)

