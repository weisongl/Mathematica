(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26060,        714]
NotebookOptionsPosition[     24781,        670]
NotebookOutlinePosition[     25149,        686]
CellTagsIndexPosition[     25106,        683]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["set up", "Section",
 CellChangeTimes->{{3.711366390273569*^9, 3.7113663913786182`*^9}, 
   3.711380753428804*^9}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{3.71025780176398*^9, 3.711380753429488*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"J", "=", "1.0"}], ";", 
  RowBox[{"G", "=", "1.0"}], ";", 
  RowBox[{"Gp", "=", "1.0"}], ";"}]], "Input",
 CellChangeTimes->{{3.711124981663788*^9, 3.711124990378647*^9}, 
   3.711125186976192*^9, 3.711142092520384*^9, {3.7111428637495527`*^9, 
   3.71114286697314*^9}, 3.711380753429792*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", 
    RowBox[{"l_", ",", "mbJ_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["\[Pi]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "mbJ"}]], ")"}], 
     RowBox[{"1", "/", "2"}]], 
    RowBox[{"BesselI", "[", 
     RowBox[{
      RowBox[{"l", "+", 
       RowBox[{"1", "/", "2"}]}], ",", "mbJ"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.710849386706348*^9, 3.710849456855394*^9}, 
   3.710849490721664*^9, {3.7108495750499353`*^9, 3.710849576984111*^9}, 
   3.711125122199246*^9, {3.711142098822711*^9, 3.711142110949444*^9}, {
   3.711142214359117*^9, 3.711142224477004*^9}, {3.711142902464776*^9, 
   3.711142906542761*^9}, 3.711147919651932*^9, 3.711148547019434*^9, {
   3.7111485900970373`*^9, 3.711148592515333*^9}, 3.711380753430169*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cl", "[", 
   RowBox[{"l_", ",", "1"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"l", "+", "1"}], 
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "l"}], "+", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "l"}], "+", "3"}], ")"}]}]]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cl", "[", 
   RowBox[{"l_", ",", 
    RowBox[{"-", "1"}]}], "]"}], ":=", 
  FractionBox["l", 
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "l"}], "+", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "l"}], "-", "1"}], ")"}]}]]]}]}], "Input",
 CellChangeTimes->{{3.7108497989145727`*^9, 3.710849840735776*^9}, 
   3.710849891317708*^9, {3.710849951824738*^9, 3.7108499551421127`*^9}, {
   3.710849993335535*^9, 3.710850113963202*^9}, {3.71111924002804*^9, 
   3.711119240882636*^9}, {3.7111393272699423`*^9, 3.711139355248748*^9}, 
   3.7113807534305887`*^9}],

Cell["\<\
when l1=l2=l the F[l1,l2] would be F[l,l] and when l2=l+\[CurlyEpsilon] then  \
F[l1,l2] would be F[l,l+\[CurlyEpsilon]]\
\>", "Text",
 CellChangeTimes->{{3.711125640073327*^9, 3.711125676369707*^9}, 
   3.7113807534307117`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"l1_", ",", "l2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"L", "=", "0"}], 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", " ", "l1"}], ",", 
        RowBox[{"2", "l2"}]}], "]"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "L"}], "+", "1"}], ")"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"ClebschGordan", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"L", ",", "0"}], "}"}]}], "]"}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"ClebschGordan", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"L", ",", "0"}], "}"}]}], "]"}], ")"}], "2"]}], ")"}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "l1"}], "+", "1"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "l2"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"0", ",", "0"}], "]"}], ":=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "]"}], ":=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ":=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.711109342148683*^9, 3.711109381755047*^9}, {
   3.711109414512463*^9, 3.711109464279454*^9}, {3.711120982062253*^9, 
   3.711120988599359*^9}, {3.711121175285327*^9, 3.711121196552683*^9}, {
   3.711121678594081*^9, 3.711121678687899*^9}, {3.711123930070739*^9, 
   3.711123934221833*^9}, 3.711124001170452*^9, {3.7111394503881397`*^9, 
   3.7111394529785547`*^9}, {3.7111396647552834`*^9, 3.711139708897235*^9}, {
   3.711365690501236*^9, 3.711365716360476*^9}, 3.711366063023302*^9, 
   3.711366241672559*^9, {3.711380656800967*^9, 3.7113806624102287`*^9}, 
   3.711380753431443*^9, {3.711381467169746*^9, 3.7113814704493227`*^9}, {
   3.711381537920826*^9, 3.711381540270194*^9}, {3.711381573020391*^9, 
   3.7113815793787727`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u1", "[", 
   RowBox[{"l_", ",", "\[CurlyEpsilon]_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"F", "[", 
     RowBox[{"l", ",", 
      RowBox[{"l", "+", "\[CurlyEpsilon]"}]}], "]"}], 
    RowBox[{"F", "[", 
     RowBox[{"l", ",", "l"}], "]"}]], 
   FractionBox[
    RowBox[{"\[Lambda]", "[", 
     RowBox[{
      RowBox[{"l", "+", "\[CurlyEpsilon]"}], ",", 
      RowBox[{"-", "bJ"}]}], "]"}], 
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"l", ",", 
      RowBox[{"-", "bJ"}]}], "]"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u2", "[", 
   RowBox[{"l_", ",", "\[CurlyEpsilon]_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"F", "[", 
     RowBox[{"l", ",", 
      RowBox[{"l", "+", "\[CurlyEpsilon]"}]}], "]"}], 
    RowBox[{"F", "[", 
     RowBox[{"l", ",", "l"}], "]"}]], 
   FractionBox[
    RowBox[{"\[Lambda]", "[", 
     RowBox[{
      RowBox[{"l", "+", "\[CurlyEpsilon]"}], ",", 
      RowBox[{"-", "bJ"}]}], "]"}], 
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"l", ",", 
      RowBox[{"-", "bJ"}]}], "]"}]]}]}]}], "Input",
 CellChangeTimes->{{3.7108510572873173`*^9, 3.7108510686661654`*^9}, {
   3.710851135651238*^9, 3.710851136298238*^9}, {3.711118899097736*^9, 
   3.711118903517767*^9}, {3.711125135392777*^9, 3.7111251406600647`*^9}, 
   3.711125361715797*^9, {3.711142271992725*^9, 3.711142304679878*^9}, 
   3.7111423412081127`*^9, {3.7111430769827757`*^9, 3.7111430897178383`*^9}, 
   3.711380753431964*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"W1", "[", 
   RowBox[{"l_", ",", "\[CurlyEpsilon]_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"u1", "[", 
        RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], "2"]}], 
     ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"u2", "[", 
        RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], "2"]}], 
     ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"u1", "[", 
     RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], " ", 
    RowBox[{"u2", "[", 
     RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W2", "[", 
   RowBox[{"l_", ",", "\[CurlyEpsilon]_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", 
       RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"u2", "[", 
          RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], "2"]}], 
       ")"}]}], "+", 
     RowBox[{
      RowBox[{"u2", "[", 
       RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"u1", "[", 
          RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], "2"]}], 
       ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W3", "[", 
   RowBox[{"l_", ",", "\[CurlyEpsilon]_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"u1", "[", 
       RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], "2"]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"u2", "[", 
       RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}], "2"]}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.710851076574082*^9, 3.71085113798936*^9}, {
   3.711108018861569*^9, 3.711108021026393*^9}, {3.7111189146516533`*^9, 
   3.711118923443478*^9}, {3.711119006897592*^9, 3.7111190278707047`*^9}, {
   3.7111423485108624`*^9, 3.711142365758243*^9}, {3.711142533093953*^9, 
   3.711142556869082*^9}, {3.711143047792699*^9, 3.711143068943626*^9}, {
   3.711366740310093*^9, 3.711366741879447*^9}, 3.711380753432579*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Chi]l\[CurlyEpsilon]", "[", 
   RowBox[{"l_", ",", "\[CurlyEpsilon]_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["bJ", 
    RowBox[{"6", " ", "J"}]], 
   SuperscriptBox[
    RowBox[{"cl", "[", 
     RowBox[{"l", ",", "\[CurlyEpsilon]"}], "]"}], "2"], " ", 
   FractionBox[
    RowBox[{"F", "[", 
     RowBox[{"l", ",", 
      RowBox[{"l", "+", "\[CurlyEpsilon]"}]}], "]"}], 
    RowBox[{"F", "[", 
     RowBox[{"l", ",", "l"}], "]"}]], 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["G", "2"], "+", 
        SuperscriptBox["Gp", "2"]}], ")"}], 
      RowBox[{"W1", "[", 
       RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}]}], "+", 
     RowBox[{"2", "G", " ", "Gp", " ", 
      RowBox[{"W2", "[", 
       RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}]}]}], 
    RowBox[{"W3", "[", 
     RowBox[{"l", ",", "\[CurlyEpsilon]", ",", "bJ"}], "]"}]]}]}]], "Input",
 CellChangeTimes->{{3.710858143078228*^9, 3.710858144538473*^9}, {
   3.71085886927529*^9, 3.710858870273925*^9}, 3.710859070948235*^9, {
   3.711107614021298*^9, 3.711107620785995*^9}, {3.71111904629323*^9, 
   3.71111906692428*^9}, {3.711119246169837*^9, 3.711119247218525*^9}, {
   3.7111424716676893`*^9, 3.7111424978990803`*^9}, {3.7111425694962187`*^9, 
   3.711142575071714*^9}, {3.711142651005292*^9, 3.711142661242777*^9}, {
   3.7111428524549*^9, 3.711142852878645*^9}, {3.7111429737395678`*^9, 
   3.7111429913302803`*^9}, {3.711366461133095*^9, 3.711366495882143*^9}, 
   3.711380753433271*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{"n_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"4", "\[Pi]"}], ")"}], 
    RowBox[{"8", 
     SuperscriptBox["n", "2"]}]], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"l", "=", "0"}], "n"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "\[Pi]"}], ")"}], "2"]], 
       RowBox[{"F", "[", 
        RowBox[{"l", ",", "l"}], "]"}], " ", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"l", ",", 
          RowBox[{"-", "bJ"}]}], "]"}], "^", "2"}]}], ")"}], 
     RowBox[{"4", 
      SuperscriptBox["n", "2"]}]]}]}]}]], "Input",
 CellChangeTimes->{{3.710858927033074*^9, 3.7108590209912243`*^9}, {
   3.710859052977799*^9, 3.710859067226894*^9}, {3.7108695730877457`*^9, 
   3.7108695805721073`*^9}, {3.711107808667635*^9, 3.711107810763358*^9}, {
   3.711107981071932*^9, 3.7111079859883623`*^9}, {3.711108384167207*^9, 
   3.7111084863213177`*^9}, {3.71110995593353*^9, 3.7111099861959743`*^9}, {
   3.711121976184318*^9, 3.711121978907261*^9}, 3.711122274598597*^9, 
   3.711123996307782*^9, {3.711125216051854*^9, 3.711125220928855*^9}, {
   3.711125343104854*^9, 3.711125344498505*^9}, {3.711142672593437*^9, 
   3.711142683864163*^9}, {3.7111429427908907`*^9, 3.7111429489702063`*^9}, {
   3.711144832000107*^9, 3.711144834456702*^9}, 3.711144908695599*^9, {
   3.7111454001467133`*^9, 3.71114540808185*^9}, {3.711366821070841*^9, 
   3.711366827491189*^9}, 3.711366997639203*^9, {3.711367529911099*^9, 
   3.711367530251175*^9}, 3.7113681795032663`*^9, {3.711380684538464*^9, 
   3.711380697208198*^9}, 3.711380753433662*^9, {3.711380851514106*^9, 
   3.711380853488843*^9}, 3.711381586010668*^9, {3.71138222215003*^9, 
   3.711382249368503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Chi]", "[", 
   RowBox[{"n_", ",", "bJ_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"Z", "[", 
     RowBox[{"n", ",", "bJ"}], "]"}]], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"l", "=", "0"}], "n"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "2"]], 
         RowBox[{"F", "[", 
          RowBox[{"l", ",", "l"}], "]"}], " ", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "bJ"}]}], "]"}], " ", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "bJ"}]}], "]"}]}], ")"}], 
       RowBox[{"4", 
        SuperscriptBox["n", "2"]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Chi]l\[CurlyEpsilon]", "[", 
         RowBox[{"l", ",", "1", ",", "bJ"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"KroneckerDelta", "[", "l", "]"}]}], ")"}], "*", 
         RowBox[{"\[Chi]l\[CurlyEpsilon]", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "1"}], ",", "bJ"}], "]"}]}]}], ")"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7108588748958797`*^9, 3.710858894023636*^9}, {
   3.710859034588854*^9, 3.7108590358596163`*^9}, {3.710859684203651*^9, 
   3.710859790111697*^9}, {3.710859838191595*^9, 3.7108598712951803`*^9}, {
   3.710859903365242*^9, 3.710859916116231*^9}, {3.7108600962010937`*^9, 
   3.710860108592698*^9}, {3.710861443421336*^9, 3.710861455109819*^9}, {
   3.710869586234948*^9, 3.710869622727358*^9}, {3.710869882951695*^9, 
   3.710869944177248*^9}, {3.711107715164176*^9, 3.711107720086836*^9}, 
   3.711107825571918*^9, {3.711107899955267*^9, 3.711107906940371*^9}, {
   3.711107961283444*^9, 3.711107991164913*^9}, {3.711108075947279*^9, 
   3.7111080883709*^9}, {3.7111081275454493`*^9, 3.711108169240745*^9}, {
   3.711109502179432*^9, 3.711109520335802*^9}, {3.711109604483779*^9, 
   3.711109630326264*^9}, {3.7111097430020123`*^9, 3.711109780469054*^9}, {
   3.711109888545209*^9, 3.711109909159171*^9}, {3.7111100036162167`*^9, 
   3.711110018219954*^9}, {3.711110067915723*^9, 3.711110089660714*^9}, {
   3.711119276915221*^9, 3.711119287367743*^9}, {3.71111982465585*^9, 
   3.711119824933652*^9}, {3.711119856339878*^9, 3.711119866736596*^9}, {
   3.711120076167774*^9, 3.711120081880624*^9}, 3.7111202201413527`*^9, 
   3.7111210278409853`*^9, {3.711121909742981*^9, 3.711121923416937*^9}, 
   3.711122266205063*^9, {3.711122767245282*^9, 3.711122800525185*^9}, 
   3.7111235122489147`*^9, 3.711123554848085*^9, 3.711125155953259*^9, {
   3.711125230660419*^9, 3.711125262081478*^9}, {3.71112533939475*^9, 
   3.711125341209875*^9}, {3.711142686722102*^9, 3.711142707047871*^9}, {
   3.711142952285603*^9, 3.7111429685486813`*^9}, 3.7111904309377327`*^9, {
   3.711366834018815*^9, 3.7113668358502283`*^9}, {3.711366992532774*^9, 
   3.711366993782793*^9}, {3.7113675319266367`*^9, 3.7113675322408867`*^9}, 
   3.711368177846423*^9, 3.7113807534341583`*^9, {3.711380854470727*^9, 
   3.711380856935781*^9}, 3.711382351722445*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"\[Chi]", "[", 
    RowBox[{"10", ",", "1"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.71136681181771*^9, 3.7113807534343977`*^9, 3.711381503130745*^9, {
   3.711382253311236*^9, 3.711382306087208*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
RowBox[{RowBox[{\\\"0.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.`\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]]\\) encountered.\"",
   2,93,3,32445970506323709907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7113823123906317`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"0.`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"0.`\\\", \\\" \\\", \\\"\
\[ImaginaryI]\\\"}]}], \\\")\\\"}], \\\"1.`\\\"]]\\) encountered.\"",2,93,4,
   32445970506323709907,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711382312397736*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.259719`", ",", "ComplexInfinity"}], "}"}]], "Output",
 CellChangeTimes->{
  3.711381551119681*^9, 3.711381617382682*^9, {3.711382256646172*^9, 
   3.711382312398806*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["evaluation", "Section",
 CellChangeTimes->{{3.711366399717924*^9, 3.7113664038253937`*^9}, 
   3.7113807534344587`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"t1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "*", "0.1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "9"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t2", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "*", "1.0"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "*", "10"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temperature", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"graph", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"Chop", "[", 
         RowBox[{"T", " ", 
          RowBox[{"\[Chi]", "[", 
           RowBox[{"10", ",", 
            RowBox[{"1", "/", "T"}]}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "t2"}], "}"}]}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.711123441194434*^9, 3.7111234499778*^9}, {
   3.7111235747543707`*^9, 3.7111235788505487`*^9}, {3.7111242715058813`*^9, 
   3.711124271838231*^9}, 3.711124315419916*^9, 3.711124959389892*^9, 
   3.711125329198222*^9, {3.7111417759634867`*^9, 3.711141785961281*^9}, {
   3.71114272001577*^9, 3.711142767702979*^9}, 3.711142884542912*^9, 
   3.711143161186458*^9, {3.711144839576449*^9, 3.7111448600986967`*^9}, 
   3.711151450406592*^9, {3.7111532894855623`*^9, 3.711153293373189*^9}, {
   3.7111879362282457`*^9, 3.711187936683383*^9}, 3.711189884704636*^9, {
   3.711189981676531*^9, 3.711190073328334*^9}, 3.711190175668561*^9, 
   3.711190423961956*^9, 3.7113684884196777`*^9, {3.711369114074806*^9, 
   3.7113691978256807`*^9}, {3.711369422314753*^9, 3.7113694421974297`*^9}, 
   3.711380753434811*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot", "[", "graph", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.711369099448098*^9, 3.7113691022460413`*^9}, 
   3.711380753435019*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"\[Chi]", "[", 
        RowBox[{"n", ",", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "5"}], "}"}]}], "]"}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.711125431938939*^9, 3.711125480880947*^9}, {
   3.711141803656994*^9, 3.711141805511725*^9}, {3.711142778868434*^9, 
   3.711142789147821*^9}, 3.711142875574912*^9, 3.711143170593997*^9, {
   3.7111514492152557`*^9, 3.711151458593831*^9}, 3.7111901678283253`*^9, 
   3.711380435623465*^9, 3.7113807534352703`*^9, {3.711380791195142*^9, 
   3.711380793829673*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "0.03042703519097266`"},
    {"2", "0.030414001080104718`"},
    {"3", "0.030414001080092887`"},
    {"4", "0.030414001080092883`"},
    {"5", "0.030414001080092887`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.711380710333687*^9, {3.711380753435684*^9, 3.7113807610810213`*^9}, 
   3.711380859266924*^9, 3.7113814804400053`*^9, 3.711381554240279*^9, 
   3.71138162051613*^9, {3.7113822600119963`*^9, 3.71138228754874*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"t1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"i", "*", "1.0"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "3", ",", "4"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"t2", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"i", "*", "10.0"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "3", ",", "4"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"temperature", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "t2"}], "}"}], "]"}], "\[IndentingNewLine]", 
      "sus"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], "T"], 
         RowBox[{"\[Chi]", "[", 
          RowBox[{"20", ",", 
           RowBox[{"1", "/", "T"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"T", ",", "temperature"}], "}"}]}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"data", "=", 
    RowBox[{
     RowBox[{"TableForm", "[", " ", 
      RowBox[{"Flatten", " ", "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"temperature", ",", "sus"}], "}"}], "]"}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
      "\"\<~/Dropbox/simulation/heisenberg/chi.dat\>\"", ",", "data"}], 
      "]"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.711300079020734*^9, 3.711368467302367*^9, {3.711368607855309*^9, 
   3.7113686109242764`*^9}, {3.7113804389329576`*^9, 3.711380449513706*^9}, {
   3.71138073361847*^9, 3.711380753436235*^9}, 3.711381597950234*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.710518714802487*^9, 3.7105187435589247`*^9}, {
   3.710518785201075*^9, 3.710518788632821*^9}, {3.710518836698289*^9, 
   3.710518840343602*^9}, {3.710518871495678*^9, 3.710518873422512*^9}, 
   3.710585153052916*^9, {3.71058520075627*^9, 3.7105852097869787`*^9}, 
   3.710588961325369*^9, 3.7105890472414827`*^9, {3.710606687324387*^9, 
   3.710606688675849*^9}, {3.710690504161701*^9, 3.7106905351288652`*^9}, 
   3.711151018426385*^9, {3.711151055069702*^9, 3.711151081338291*^9}, 
   3.7111514750399303`*^9, 3.711151521172241*^9, 3.711152844051181*^9, 
   3.7111529382919693`*^9, {3.711153259246908*^9, 3.7111532693680973`*^9}, 
   3.711153331560473*^9, {3.711190161026679*^9, 3.711190166316792*^9}, {
   3.71119033490274*^9, 3.711190391243635*^9}, 3.7111904572250233`*^9, {
   3.711212901682131*^9, 3.7112129018018007`*^9}, 3.711368471339355*^9, 
   3.711368606927841*^9, 3.711380753483282*^9}]
}, Open  ]]
},
WindowSize->{1366, 671},
WindowMargins->{{1, Automatic}, {Automatic, 11}},
Magnification:>2. Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 119, 2, 129, "Section"],
Cell[702, 26, 139, 2, 70, "Input"],
Cell[844, 30, 327, 7, 64, "Input"],
Cell[1174, 39, 863, 21, 93, "Input"],
Cell[2040, 62, 984, 31, 214, "Input"],
Cell[3027, 95, 238, 5, 64, "Text"],
Cell[3268, 102, 2539, 70, 410, "Input"],
Cell[5810, 174, 1519, 42, 198, "Input"],
Cell[7332, 218, 2422, 68, 255, "Input"],
Cell[9757, 288, 1590, 38, 164, "Input"],
Cell[11350, 328, 1893, 43, 120, "Input"],
Cell[13246, 373, 3270, 68, 361, "Input"],
Cell[CellGroupData[{
Cell[16541, 445, 290, 7, 64, "Input"],
Cell[16834, 454, 381, 8, 79, "Message"],
Cell[17218, 464, 442, 9, 87, "Message"],
Cell[17663, 475, 212, 5, 92, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17924, 486, 125, 2, 129, "Section"],
Cell[18052, 490, 2160, 56, 237, "Input"],
Cell[20215, 548, 184, 4, 64, "Input"],
Cell[CellGroupData[{
Cell[20424, 556, 719, 17, 64, "Input"],
Cell[21146, 575, 918, 23, 230, "Output"]
}, Open  ]],
Cell[22079, 601, 1735, 51, 296, "Input"],
Cell[23817, 654, 948, 13, 64, "Input"]
}, Open  ]]
}
]
*)

